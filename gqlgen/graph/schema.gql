# GraphQL schema example
#
# https://gqlgen.com/getting-started/

###################################################
# Top level types
###################################################

type Query {
  # without passing step argument, you get the first step page
  page(tutorial: String!, step: String): Page

  _test: TestObjs
}

type TestObjs {
  appTestTerminalPage(step: Int): TerminalColumn2
  appTestTutorialColumnsPage: Page2
  appTestTutorialTutorialPage: Page2
  appTestSourcecodeFilecontentPage(step: Int!): OpenFile
}

###################################################
# Page state related object types
###################################################

type Page {
  step: String
  nextStep: String
  prevStep: String
  autoNextSeconds: Int
  durationSeconds: Int
  isTrivialStep: Boolean
  columns: [ColumnWrapper]
  focusColumn: String
  modal: Modal
}

###################################################
# Page 2
###################################################

type Page2 {
  step: String
  nextStep: String
  prevStep: String

  isTrivial: Boolean

  columns: [ColumnWrapper2]
  focusColumn: String

  modal: Modal
}

###################################################
# Column 2
###################################################

interface Column2 {
  _placeholder: String
}

type ColumnWrapper2 {
  column: Column2!
  columnName: String!
  columnDisplayName: String
}

###################################################
# Terminal related object types 2
###################################################

enum TerminalTooltipTiming {
  START
  END
}

type TerminalTooltip {
  markdownBody: String!
  timing: TerminalTooltipTiming
}

enum TerminalEntryType {
  COMMAND
  OUTPUT
}

type TerminalEntry {
  id: ID!
  entryType: TerminalEntryType!
  text: String! # command or output
}

type Terminal2 {
  name: String
  currentDirectory: String!
  entries: [TerminalEntry!]! # not null, no null eleement, but empty array is possible
  tooltip: TerminalTooltip
  # terminalTabs
}

type TerminalColumn2 implements Column2 {
  _placeholder: String
  terminals: [Terminal2!]!
}

###################################################
# Source Code types 2
###################################################

type SourceCodeColumn2 implements Column2 {
  _placeholder: String
  sourceCode: SourceCode2!
}

type SourceCode2 {
  # step is necessary for the resolver to return step-specific OpenFile data
  step: String
  projectDir: String
  fileTree: [FileNode]
  isFoldFileTree: Boolean
  # If you don't pass `filePath` argument, you get the default OpenFile for the step
  openFile(filePath: String): OpenFile
}

###################################################
# Source Column 2
###################################################

type Browser {
  width: Int!
  height: Int!
  path: String!
}

type BrowserColumn2 implements Column2 {
  _placeholder: String
  browser: Browser!
}

###################################################
# Columns
###################################################

# wrap around Column, which is friendly for frontend pattern-matching
type ColumnWrapper {
  index: Int
  column: Column
  name: String
}

interface Column {
  _placeholder: String
}

enum ColumnVerticalPosition {
  TOP
  CENTER
  BOTTOM
}

enum ImageDescriptionOrder {
  IMAGE_THEN_DESCRIPTION
  DESCRIPTION_THEN_IMAGE
}

type ImageDescriptionColumn implements Column {
  _placeholder: String
  description: Markdown
  image: ImageCentered
  order: ImageDescriptionOrder
  contentsPosition: ColumnVerticalPosition
}

type BackgroundImageColumn implements Column {
  _placeholder: String
  width: Int
  height: Int
  path: String
  url: String
  modal: Modal
}

type BrowserColumn implements Column {
  _placeholder: String
  width: Int
  height: Int
  path: String
}

type DevToolsColumn implements Column {
  _placeholder: String
  width: Int
  height: Int
  path: String
}

type MarkdownColumn implements Column {
  _placeholder: String
  description: Markdown
  contentsPosition: ColumnVerticalPosition
}

type SourceCodeColumn implements Column {
  _placeholder: String
  sourceCode: SourceCode
}

type TerminalColumn implements Column {
  _placeholder: String
  terminal: Terminal
}

type YouTubeColumn implements Column {
  _placeholder: String
  youtube: YouTubeEmbed
}

###################################################
# Terminal related object types
###################################################

# TerminalElement
union TerminalElement = TerminalCommand | TerminalOutput

type TerminalCommand {
  beforeExecution: Boolean
  command: String
  tooltip: String
}

type TerminalOutput {
  output: String
  tooltip: String
}

# TerminalNode wraps around TerminalElement, which is friendly for frontend pattern-matching
type TerminalNode {
  content: TerminalElement
}

type Terminal {
  step: String
  name: String
  currentDirectory: String
  nodes: [TerminalNode] # To make frontend pattern-matching easier, we return a list of concrete object types, instead of list of unions
}

###################################################
# Source code related object types
###################################################

# Tooltip types

enum SourceCodeTooltipTiming {
  START
  END
}

type SourceCodeTooltip {
  markdownBody: String!
  lineNumber: Int!
  timing: SourceCodeTooltipTiming
}

# FileEdit types

type MonacoEditOperation {
  text: String!
  range: MonacoEditRange!
}

type EditSequence {
  id: ID!
  edits: [MonacoEditOperation!]
}

type MonacoEditRange {
  startLineNumber: Int!
  startColumn: Int!
  endLineNumber: Int!
  endColumn: Int!
}

# FileNode types

enum FileNodeType {
  FILE
  DIRECTORY
}

type FileNode {
  nodeType: FileNodeType!
  name: String
  filePath: String!
  offset: Int
  isUpdated: Boolean
  isDeleted: Boolean
}

# OpenFile types

# To be deprecated as Monaco Diff Editor will be used
type FileHighlight {
  fromLine: Int
  toLine: Int
}

type OpenFile {
  filePath: String
  fileName: String
  content: String
  oldContent: String
  isFullContent: Boolean
  language: String
  size: Float
  editSequence: EditSequence
  tooltip: SourceCodeTooltip

  # To be deprecated as Monaco Diff Editor will be used
  highlight: [FileHighlight]
}

# SourceCode type

type SourceCode {
  # step is necessary for the resolver to return step-specific OpenFile data
  step: String
  projectDir: String
  fileTree: [FileNode]
  isFoldFileTree: Boolean
  # If you don't pass `filePath` argument, you get the default OpenFile for the step
  openFile(filePath: String): OpenFile
}

###################################################
# Markdown related object types
###################################################

enum MarkdownAlignment {
  LEFT
  CENTER
}

type MarkdownOld {
  step: String
  contents: String
}

type Markdown {
  step: String
  contents: String
  alignment: MarkdownAlignment
}

###################################################
# Modal related object types
###################################################

enum ModalPosition {
  TOP
  CENTER
  BOTTOM
}

type Modal {
  text: String
  position: ModalPosition
}

###################################################
# Image-centered related object types
###################################################

type ImageCentered {
  width: Int
  height: Int
  path: String
  url: String
}

###################################################
# Video related object types
###################################################

type YouTubeEmbed {
  width: Int
  height: Int
  embedUrl: String
}
